diff -Naurp u-boot-2009.08.org/board/nxp/vpe_apollo/config.mk u-boot-2009.08/board/nxp/vpe_apollo/config.mk
--- u-boot-2009.08.org/board/nxp/vpe_apollo/config.mk	2010-03-02 21:30:08.000000000 -0600
+++ u-boot-2009.08/board/nxp/vpe_apollo/config.mk	2010-03-03 10:07:43.000000000 -0600
@@ -28,4 +28,4 @@
 # (mem base + reserved)
 
 # For use with external or internal boots.
-TEXT_BASE = 0x0a000000
+TEXT_BASE = 0x4000000
diff -Naurp u-boot-2009.08.org/common/cmd_nor.c u-boot-2009.08/common/cmd_nor.c
--- u-boot-2009.08.org/common/cmd_nor.c	2010-03-02 21:30:09.000000000 -0600
+++ u-boot-2009.08/common/cmd_nor.c	2010-03-03 15:23:08.000000000 -0600
@@ -107,7 +107,7 @@ int do_nor(cmd_tbl_t * cmdtp, int flag, 
 		if (argc < 4)
 			goto usage1;
 
-	   off = (ulong)simple_strtoul(argv[2], NULL, 16);
+		off = (ulong)simple_strtoul(argv[2], NULL, 16);
 		size = (ulong)simple_strtoul(argv[3], NULL, 16);
 	
 		printf ("## NOR Flash Offset %x ...\n", off);
@@ -115,8 +115,8 @@ int do_nor(cmd_tbl_t * cmdtp, int flag, 
 	
 		puts("U-Boot -- Erasing NOR flash\n");
 
-      nor_erase_info.addr = off;
-      nor_erase_info.len = size;
+		nor_erase_info.addr = off;
+		nor_erase_info.len = size;
 		nor_erase(&nor_info, &nor_erase_info) ;
     
 		puts("U-Boot -- Erasing NOR flash.....Done\n");
diff -Naurp u-boot-2009.08.org/common/env_flash.c u-boot-2009.08/common/env_flash.c
--- u-boot-2009.08.org/common/env_flash.c	2010-03-02 21:30:09.000000000 -0600
+++ u-boot-2009.08/common/env_flash.c	2010-03-03 15:04:38.000000000 -0600
@@ -32,7 +32,7 @@
 #include <linux/stddef.h>
 #include <malloc.h>
 #include <nor.h>
-
+#include "stbcfg.h"
 
 DECLARE_GLOBAL_DATA_PTR;
 
@@ -66,10 +66,10 @@ static env_t *flash_addr = (env_t *)CONF
 
 #else /* ! ENV_IS_EMBEDDED */
 
-env_t *env_ptr = (env_t *)((ulong)CONFIG_ENV_ADDR | 0xC00E0000);
+env_t *env_ptr = (env_t *)((ulong)CONFIG_ENV_ADDR | CONFIG_SYS_FLASH_BASE);
 //env_t *env_ptr = (env_t *)CONFIG_ENV_ADDR
 #ifdef CMD_SAVEENV
-static env_t *flash_addr = (env_t *)CONFIG_ENV_ADDR;
+static env_t *flash_addr = (env_t *)(CONFIG_ENV_ADDR);
 #endif
 
 #endif /* ENV_IS_EMBEDDED */
@@ -178,7 +178,7 @@ int saveenv(void)
 				up_data, saved_data);
 	}
 #endif
-	puts ("Erasing Flash...");
+	puts ("Erasing Flash...\n");
 	debug (" %08lX ... %08lX ...",
 		(ulong)flash_addr_new, end_addr_new);
 
@@ -186,7 +186,7 @@ int saveenv(void)
 		goto Done;
 	}
 
-	puts ("Writing to Flash... ");
+	puts ("Writing to Flash...\n");
 	debug (" %08lX ... %08lX ...",
 		(ulong)&(flash_addr_new->data),
 		sizeof(env_ptr->data)+(ulong)&(flash_addr_new->data));
@@ -287,7 +287,7 @@ int saveenv(void)
 		flash_sect_addr, (ulong)flash_addr, flash_offset);
 
 	/* copy old contents to temporary buffer */
-	memcpy (env_buffer, (void *)(flash_sect_addr | 0xC00E0000), CONFIG_ENV_SECT_SIZE);
+	memcpy (env_buffer, (void *)(flash_sect_addr | CONFIG_SYS_FLASH_BASE), CONFIG_ENV_SECT_SIZE);
 
 	/* copy current environment to temporary buffer */
 	memcpy ((uchar *)((unsigned long)env_buffer),
@@ -309,7 +309,7 @@ int saveenv(void)
 #else
 	/* this is the last sector, and the size is hardcoded here */
 	/* otherwise we will get stack problems on loading 128 KB environment */
-	end_addr = flash_sect_addr + 0x20000 - 1;
+	end_addr = flash_sect_addr + len - 1;
 #endif
 #if 0
 	debug ("Protect off %08lX ... %08lX\n",
@@ -318,7 +318,7 @@ int saveenv(void)
 	if (flash_sect_protect (0, flash_sect_addr, end_addr))
 		return 1;
 #endif
-	puts ("Erasing Flash...");
+	puts ("Erasing Flash...\n");
 #if 0
 	if (flash_sect_erase (flash_sect_addr, end_addr))
 		return 1;
@@ -327,7 +327,7 @@ int saveenv(void)
    nor_erase_info.len = end_addr - flash_sect_addr;
    nor_erase(&nor_info, &nor_erase_info) ;
 
-	puts ("Writing to Flash... ");
+	puts ("Writing to Flash...\n");
    nor_write(&nor_info, (loff_t)flash_sect_addr, (size_t *)(&len), (u_char *)env_buffer) ;
   
 #if 0
@@ -394,7 +394,7 @@ void env_relocate_spec (void)
 		      "reading environment; recovered successfully\n\n");
 #endif /* CONFIG_ENV_ADDR_REDUND */
 #ifdef CMD_SAVEENV
-	memcpy (env_ptr, (void*)((ulong)flash_addr | 0xC00E0000), CONFIG_ENV_SIZE);
+	memcpy (env_ptr, (void*)((ulong)flash_addr | CONFIG_SYS_FLASH_BASE), CONFIG_ENV_SIZE);
 #endif
 #endif /* ! ENV_IS_EMBEDDED || CONFIG_ENV_ADDR_REDUND */
 }
diff -Naurp u-boot-2009.08.org/cpu/arm_cortexa8/pnx84xx/config.mk u-boot-2009.08/cpu/arm_cortexa8/pnx84xx/config.mk
--- u-boot-2009.08.org/cpu/arm_cortexa8/pnx84xx/config.mk	2010-03-02 21:30:08.000000000 -0600
+++ u-boot-2009.08/cpu/arm_cortexa8/pnx84xx/config.mk	2010-03-03 14:33:59.000000000 -0600
@@ -24,7 +24,9 @@ PLATFORM_RELFLAGS += -fno-strict-aliasin
 		     -msoft-float
 
 # Make ARMv5 to allow more compilers to work, even though its v7a.
-PLATFORM_CPPFLAGS += -march=armv5
+PLATFORM_CPPFLAGS += -march=armv5 -D__UBOOT__ -DSWCONFIG_INCL=1
+PLATFORM_CPPFLAGS += -I$(_TMROOT)/inc
+PLATFORM_CPPFLAGS += -I$(_TMTGTBUILDROOT)/cfgtoh/$(STB_HW_CONFIG)-$(STB_SW_CONFIG)
 # =========================================================================
 #
 # Supply options according to compiler version
diff -Naurp u-boot-2009.08.org/cpu/arm_cortexa8/pnx84xx/sys_info.c u-boot-2009.08/cpu/arm_cortexa8/pnx84xx/sys_info.c
--- u-boot-2009.08.org/cpu/arm_cortexa8/pnx84xx/sys_info.c	2010-03-02 21:30:08.000000000 -0600
+++ u-boot-2009.08/cpu/arm_cortexa8/pnx84xx/sys_info.c	2010-03-03 15:09:41.000000000 -0600
@@ -55,7 +55,6 @@ void dieid_num_r(void)
 		uid_s = die_id;
 	}
 
-	printf("Die ID #%s\n", uid_s);
 }
 
 /******************************************
diff -Naurp u-boot-2009.08.org/cpu/arm_cortexa8/pnx84xx/timer.c u-boot-2009.08/cpu/arm_cortexa8/pnx84xx/timer.c
--- u-boot-2009.08.org/cpu/arm_cortexa8/pnx84xx/timer.c	2010-03-02 21:30:09.000000000 -0600
+++ u-boot-2009.08/cpu/arm_cortexa8/pnx84xx/timer.c	2010-03-03 13:28:36.000000000 -0600
@@ -61,7 +61,12 @@ static gptimer_t *timer_base = (gptimer_
 
 void reset_cpu (ulong addr)
 {
-	__REG(PNX84XX_RGU_BASE+NXP_PNX8400_RGU_SMARTCARD) = 1;
+        writel(0xf8, PNX84XX_RESET_LOCKCMD);
+        writel(0x2b, PNX84XX_RESET_LOCKCMD);
+        writel(0x1, PNX84XX_RESET_LOCKSTAT);
+        writel(0x1, PNX84XX_RESET_SOFTRESET);
+
+//	__REG(PNX84XX_RGU_BASE+NXP_PNX8400_RGU_SMARTCARD) = 1;
 }
 
 
diff -Naurp u-boot-2009.08.org/cpu/arm_cortexa8/start.S u-boot-2009.08/cpu/arm_cortexa8/start.S
--- u-boot-2009.08.org/cpu/arm_cortexa8/start.S	2010-03-02 21:30:08.000000000 -0600
+++ u-boot-2009.08/cpu/arm_cortexa8/start.S	2010-03-03 13:27:43.000000000 -0600
@@ -111,7 +111,7 @@ reset:
 	bic	r0, r0, #0x1f
 	orr	r0, r0, #0xd3
 	msr	cpsr,r0
-#if (CONFIG_PNX_EMU) 	/* working on emulator */
+#if 0 /*(CONFIG_PNX_EMU)*/ 	/* working on emulator */
 debug:
 	ldr r1,uart_addr
 	mov r2,#0x39
diff -Naurp u-boot-2009.08.org/drivers/mtd/nor/Makefile u-boot-2009.08/drivers/mtd/nor/Makefile
--- u-boot-2009.08.org/drivers/mtd/nor/Makefile	2010-03-02 21:30:09.000000000 -0600
+++ u-boot-2009.08/drivers/mtd/nor/Makefile	2010-03-03 15:27:23.000000000 -0600
@@ -33,8 +33,6 @@ COBJS-y += nor_flashamd.o
 #COBJS-y += dmac.o
 #COBJS-y += ip2070gcs.o
 endif
-HOSTCFLAGS += -I $(_TMROOT)/inc
-HOSTCFLAGS += -I $(_TMTGTBUILDROOT)/cfgtoh/$(STB_HW_CONFIG)-bare
 HOSTCFLAGS += -I $(SRCTREE)/lib_arm
 HOSTCFLAGS += -D__UBOOT__
 CFLAGS += $(HOSTCFLAGS)
diff -Naurp u-boot-2009.08.org/drivers/net/Makefile u-boot-2009.08/drivers/net/Makefile
--- u-boot-2009.08.org/drivers/net/Makefile	2010-03-02 21:30:09.000000000 -0600
+++ u-boot-2009.08/drivers/net/Makefile	2010-03-03 15:27:15.000000000 -0600
@@ -79,8 +79,6 @@ COBJS-$(CONFIG_XILINX_EMACLITE) += xilin
 COBJS-$(CONFIG_LIPP_6300ETH) += lipp_6300eth/lipp_6300eth.o \
 				lipp_6300eth/tmbslPhy.o
 
-HOSTCFLAGS += -I $(_TMROOT)/inc
-HOSTCFLAGS += -I $(_TMTGTBUILDROOT)/cfgtoh/$(STB_HW_CONFIG)-bare
 CFLAGS += $(HOSTCFLAGS)
 
 COBJS	:= $(COBJS-y)
diff -Naurp u-boot-2009.08.org/include/asm-arm/arch-pnx84xx/pnx84xx.h u-boot-2009.08/include/asm-arm/arch-pnx84xx/pnx84xx.h
--- u-boot-2009.08.org/include/asm-arm/arch-pnx84xx/pnx84xx.h	2010-03-02 21:30:09.000000000 -0600
+++ u-boot-2009.08/include/asm-arm/arch-pnx84xx/pnx84xx.h	2010-03-03 13:14:46.000000000 -0600
@@ -115,6 +115,16 @@ typedef struct global_reg {
 #define IP3012_TIMER_COUNTER	0x04	/* rw */
 #define IP3012_TIMER_PRESCALE	0x08	/* rw */
 
+/* Reset control */
+#define PNX84XX_RESET_BASE                       (PNX84XX_L4_IO_BASE + 0xE6000)
+#define PNX84XX_RESET_LOCKCMD_OFFSET             0x28
+#define PNX84XX_RESET_LOCKSTAT_OFFSET            0x2c
+#define PNX84XX_RESET_SOFTRESET_OFFSET           0x08
+/* device names to be used */
+#define PNX84XX_RESET_LOCKCMD                    (PNX84XX_RESET_BASE + PNX84XX_RESET_LOCKCMD_OFFSET)
+#define PNX84XX_RESET_LOCKSTAT                   (PNX84XX_RESET_BASE + PNX84XX_RESET_LOCKSTAT_OFFSET)
+#define PNX84XX_RESET_SOFTRESET                  (PNX84XX_RESET_BASE + PNX84XX_RESET_SOFTRESET_OFFSET)
+
 
 /* WatchDog Timers (1 GP) */
 #define WD1_BASE			    	(PNX84XX_GPT1 + 0x20)
diff -Naurp u-boot-2009.08.org/include/configs/vpe_apollo.h u-boot-2009.08/include/configs/vpe_apollo.h
--- u-boot-2009.08.org/include/configs/vpe_apollo.h	2010-03-02 21:30:09.000000000 -0600
+++ u-boot-2009.08/include/configs/vpe_apollo.h	2010-03-03 14:24:43.000000000 -0600
@@ -225,7 +225,7 @@ xxx
     #define	CONFIG_BOOTFILE "loadfiles.mi"
     #define	CONFIG_ETHADDR aa:bb:cc:dd:ee:ff
 
-    #define CONFIG_LOADADDR		0x09F00000
+    #define CONFIG_LOADADDR	  0x00008000
     #define CONFIG_BOOTP_SERVERIP 10.0.0.9 //dummy
 
 
@@ -237,7 +237,7 @@ xxx
 #if 1
 #define CONFIG_CMD_SAVEENV
 #define CONFIG_ENV_IS_IN_FLASH
-#define CONFIG_ENV_ADDR         0xE0000
+#define CONFIG_ENV_ADDR         SSBOOT_ENV_FLASH_OFFSET
 #endif
 
 
@@ -246,25 +246,25 @@ xxx
 #if defined(CONFIG_CMD_NAND)
 #undef CONFIG_ENV_IS_NOWHERE
 #define CONFIG_ENV_IS_IN_NAND
-#define CONFIG_ENV_OFFSET		0x0003C000	/* Address of Environment Sector*/
+#define CONFIG_ENV_OFFSET	0x0003C000	/* Address of Environment Sector*/
 #endif
 #endif
 
 #if defined(CFG_ONENAND)
 #undef  CONFIG_ENV_IS_NOWHERE
 #define CONFIG_ENV_IS_IN_ONENAND
-#define CONFIG_ENV_ADDR         0x00120000
+#define CONFIG_ENV_ADDR		0x00120000
 #endif
 
-#define CONFIG_ENV_SIZE		  0x00002000	/* Size of Environment Sector	*/
+#define CONFIG_ENV_SIZE		0x00010000	/* Size of Environment Sector	*/
 
-//#define CONFIG_ENV_SECT_SIZE 0x20000
+//#define CONFIG_ENV_SECT_SIZE 	0x20000
 
 /*
 #define	CONFIG_BOOTP_MASK	CONFIG_BOOTP_DEFAULT
 */
 
-#define	CONFIG_BOOTDELAY	3
+#define	CONFIG_BOOTDELAY	2
 
 
 #define CONFIG_SYS_MEM	"mem=64M"
@@ -297,7 +297,7 @@ xxx
 	"uImage=tftp 0x80180000 uImage; bootm 0x80180000\0"		\
 	"autoload=n\0"		\
 	"uboot=tftp 0x80008000 u-boot.bin; go 0x80008000\0"		\
-	"norboot=nor read 0x8000 0x180000 0x400000; go 0x8000\0"	\
+	"norboot=nor read 0x8000 0x180000 0x500000; go 0x8000\0"	\
 	"bootcmd=run norboot;\0"
 
 #if 0
@@ -399,7 +399,7 @@ xxx
  */
 
 #define CONFIG_SYS_FLASH_BASE		0xc0000000
-#define CONFIG_SYS_MONITOR_BASE		0x0A000000
+#define CONFIG_SYS_MONITOR_BASE		0x04000000
 
 #undef  CFG_NAND_LEGACY
 #undef  CFG_NAND
diff -Naurp u-boot-2009.08.org/lib_arm/board.c u-boot-2009.08/lib_arm/board.c
--- u-boot-2009.08.org/lib_arm/board.c	2010-03-02 21:30:09.000000000 -0600
+++ u-boot-2009.08/lib_arm/board.c	2010-03-03 11:05:30.000000000 -0600
@@ -352,7 +352,6 @@ void start_armboot (void)
 #else
 	mem_malloc_init (_armboot_start - CONFIG_SYS_MALLOC_LEN);
 #endif
-	puts ("==> Heap allocated.\n  ");
 
 #ifndef CONFIG_SYS_NO_FLASH
 	/* configure available FLASH banks */
@@ -410,8 +409,6 @@ void start_armboot (void)
 	/* initialize environment */
   env_relocate ();
  
-	puts ("==> Env setup done.\n  ");
-
 #ifdef CONFIG_VFD
 	/* must do this after the framebuffer is allocated */
 	drv_vfd_init();
@@ -424,13 +421,16 @@ void start_armboot (void)
 	/* IP Address */
 	gd->bd->bi_ip_addr = getenv_IPaddr ("ipaddr");
 
+#if 0
 	puts ("==> U-Boot phase 2.\n  ");
-
+#endif
 	stdio_init ();	/* get the devices list going. */
 
 	jumptable_init ();
 
+#if 0
 	puts ("==> U-Boot phase 3.\n  ");
+#endif
 
 #if defined(CONFIG_API)
 	/* Initialize API */
@@ -451,8 +451,9 @@ void start_armboot (void)
 	/* enable exceptions */
 	enable_interrupts ();
 
+#if 0
 	puts ("==> U-Boot interrupts enabled.\n  ");
-
+#endif
 	/* Perform network card initialisation if necessary */
 #ifdef CONFIG_DRIVER_TI_EMAC
 	/* XXX: this needs to be moved to board init */
diff -Naurp u-boot-2009.08.org/lib_arm/bootm.c u-boot-2009.08/lib_arm/bootm.c
--- u-boot-2009.08.org/lib_arm/bootm.c	2010-03-02 21:30:09.000000000 -0600
+++ u-boot-2009.08/lib_arm/bootm.c	2010-03-03 14:31:41.000000000 -0600
@@ -341,19 +341,14 @@ void  patch_ataglist( void )
       for( i = 0; i<cmdline_length; i++)
       {
               *tmp1++ = *tmp++;
-  //              *patch_addr++ = *cmdline_ptr++;
       }
-//      patch_addr +=cmdline_length;
-      if((u32 )tmp1 & 0x3)
-      {
-        patch_addr =  ((u32)tmp1 & ~(0x3)) + 4 ;
         *tmp1++ = 0x0;
         *tmp1++ = 0x0;
         *tmp1++ = 0x0;
-       }
-      *patch_addr++ = 0x0;
-      *patch_addr++ = 0x0;
-      *patch_addr++ = 0x0;
+        *tmp1++ = 0x0;
+        *tmp1++ = 0x0;
+        *tmp1++ = 0x0;
+        *tmp1++ = 0x0;
    }
    
 }
diff -Naurp u-boot-2009.08.org/lib_arm/flash.c u-boot-2009.08/lib_arm/flash.c
--- u-boot-2009.08.org/lib_arm/flash.c	2010-03-02 21:30:09.000000000 -0600
+++ u-boot-2009.08/lib_arm/flash.c	2010-03-03 15:04:01.000000000 -0600
@@ -127,7 +127,6 @@ void nor_init(void)
 	if (RETCODE_BOOTDEV_FLASH == ret)
 	{
 		puts("Boot Device NOR Flash\r\n") ;	
-		puts("\r Initializing the GCS\r\n") ;
 		nx_gcs_init(eBootDev, eFlashtype);	/* InitGCS */
 		/* TODO-Set up all the Flashes that are on the board */
 	}
@@ -151,30 +150,30 @@ void nor_erase_region(u_int32 addr, u_in
    u_int32 uTempflashaddr, uFlashAddr;
 
    uFlashAddr = addr;
-      nblks = uErasesize/(blksize -1) + 1;
-      uTempflashaddr = uFlashAddr;
-      for (i = 0; i < nblks; i++)
-      {
-         nx_nor_read((void *)uTempflashaddr, 
-                  (int)blksize,
-                  (void *)buffer );
-         for (j = 0; j < blksize; j++)
-         {
-            if (buffer[j] != 0xFF)
-            {
-               nx_nor_block_erase((void *)uTempflashaddr, blksize, NULL);
-               break;
-            }
-         }
-         uTempflashaddr+=blksize;
-         if ((i%8)==0)
+   nblks = (uErasesize >= blksize) ? ((uErasesize % blksize) ? (uErasesize/blksize)+1 : (uErasesize/blksize)) : 1;
+   uTempflashaddr = uFlashAddr;
+   for (i = 0; i < nblks; i++)
+   {
+      nx_nor_read((void *)uTempflashaddr, 
+                 (int)blksize,
+                 (void *)buffer );
+      for (j = 0; j < blksize; j++)
+      {
+         if (buffer[j] != 0xFF)
          {
-            printf(".");
-            z++;
-            if ((z%80)==0) printf("\r\n");
+            nx_nor_block_erase((void *)uTempflashaddr, blksize, NULL);
+            break;
          }
       }
+      uTempflashaddr+=blksize;
+      if ((i%8)==0)
+      {
+         printf(".");
+         z++;
+         if ((z%80)==0) printf("\r\n");
+      }
    }
+}
 
 void nor_write_partition(char * partition)
 {
@@ -212,7 +211,7 @@ void nor_write_region(u_int32 uFlashAddr
    u_int32 uTempflashaddr;
 
   // nblks = uErasesize/(blksize;
-   nblks = (uErasesize >= blksize) ? uErasesize/blksize : 1;
+   nblks = (uErasesize >= blksize) ? ((uErasesize % blksize) ? (uErasesize/blksize)+1 : (uErasesize/blksize)) : 1;
    uTempflashaddr = uFlashAddr;
    for (i = 0; i < nblks; i++)
    {
@@ -235,7 +234,7 @@ void nor_write_region(u_int32 uFlashAddr
          if ((z%80)==0) printf("\r\n");
       }
    }
-   nblks = (uLength >= blksize) ? uLength/blksize : 1;
+   nblks = uLength/blksize;
    for (i = 0; i < nblks; i++)
    {
       nx_nor_write( (void *)uFlashAddr, 
@@ -269,7 +268,7 @@ void nor_write_region(u_int32 uFlashAddr
                                     0xB1, 0xB0, 0x1E, 0xE4
                                  };
     /*  myprint("\r\nWriting JFFS2 clean markers!\r\n") ;*/
-      nblks = (uErasesize >= blksize) ? uErasesize/blksize : 1;
+      nblks = (uErasesize >= blksize) ? ((uErasesize % blksize) ? (uErasesize/blksize)+1 : (uErasesize/blksize)) : 1;
       for (; i < nblks; i++)
       {
          nx_nor_write( (void *)uFlashAddr, 
diff -Naurp u-boot-2009.08.org/lib_arm/ip2070gcs.c u-boot-2009.08/lib_arm/ip2070gcs.c
--- u-boot-2009.08.org/lib_arm/ip2070gcs.c	2010-03-02 21:30:09.000000000 -0600
+++ u-boot-2009.08/lib_arm/ip2070gcs.c	2010-03-03 11:09:15.000000000 -0600
@@ -129,7 +129,8 @@ retcode_t nx_gcs_init (devicetype_t eBoo
 #ifdef NOR_CS2
                      writel(GCS_NOR_CSROUTE_CS2, IPBGCSFLSHNTWK_NOR_CS_ROUTE_REG);
 #endif
-                     myprint("GCS: NOR DEVICE SETUP COMPLETE\r\n");
+                     writel(0x00022495, IPBGCSFLSHNTWK_IP_2016_APB_DEV0_READ_CFG_REG);   /* read-timing register */
+                     writel(0x00022495, IPBGCSFLSHNTWK_IP_2016_APB_DEV0_WRITE_CFG_REG);  /* write-timing register */
                      
                      break;
 
diff -Naurp u-boot-2009.08.org/lib_arm/Makefile u-boot-2009.08/lib_arm/Makefile
--- u-boot-2009.08.org/lib_arm/Makefile	2010-03-02 21:30:09.000000000 -0600
+++ u-boot-2009.08/lib_arm/Makefile	2010-03-03 15:27:32.000000000 -0600
@@ -48,10 +48,6 @@ COBJS-y	+= flash.o
 COBJS-y	+= dmac.o
 COBJS-y	+= ip2070gcs.o
 
-HOSTCFLAGS += -I $(_TMROOT)/inc
-HOSTCFLAGS += -I $(_TMTGTBUILDROOT)/cfgtoh/$(STB_HW_CONFIG)-bare
-HOSTCFLAGS += -D__UBOOT__ -DSWCONFIG_INCL=1
-
 CFLAGS += $(HOSTCFLAGS)
 
 SRCS	:= $(GLSOBJS:.o=.S) $(GLCOBJS:.o=.c) \
diff -Naurp u-boot-2009.08/include/configs/vpe_apollo.h u-boot-2009.08.new/include/configs/vpe_apollo.h
--- u-boot-2009.08/include/configs/vpe_apollo.h	2010-03-03 17:01:54.000000000 -0600
+++ u-boot-2009.08.new/include/configs/vpe_apollo.h	2010-03-03 16:55:58.000000000 -0600
@@ -329,6 +329,11 @@ xxx
 
 #define CONFIG_APOLLO
 
+#define CONFIG_AUTO_COMPLETE    1
+
+#define CONFIG_SYS_HUSH_PARSER          /* use "hush" command parser */
+#define CONFIG_SYS_PROMPT_HUSH_PS2      "> "
+
 #define	CONFIG_SYS_LONGHELP	/* undef to save memory */
 #define	CONFIG_SYS_PROMPT	V_PROMPT
 #define	CONFIG_SYS_CBSIZE	512	/* Console I/O Buffer Size */
